# How to Develop CNNs for Multi-step Energy Usage Forecasting

## Tutorial Overview

## Problem Description

## Load and Prepare Dataset

## CNNs for Multi-step Forecasting

卷积神经网络（CNN）可用于多步时间序列预测。CNN 也可用于递归或直接预测策略，在该策略中，模型进行一步预测，并为每个要预测的时间步开发一个模型。或者，CNN 可以用来预测整个输出序列，作为整个矢量的一步预测。这是前馈神经网络的普遍优势。使用 CNN 的一个重要好处是：支持多个 1D 输入以进行预测。如果多步输出序列是一个以上输入序列的函数，则此功能很有用。这可以使用两种不同的模型配置来实现。

- 多个输入通道（Multiple Input Channels）：每个输入序列作为一个单独的通道读取，可类比图像的不同颜色通道（如RGB）。
- 多个输入头（Multiple Input Heads）：每个输入序列由不同的CNN子模型读取，并且模型的内部表征在解释之前先进行组合再进行预测。按个人理解，命名为子模型异构。

本文介绍三种业务场景下的CNN模型：

- **单变量输入数据**的多步时间序列预测CNN模型；
- **多变量多输入通道**的多步时间序列预测CNN模型；
- **多变量子模型异构**的多步时间序列预测CNN模型；

这些模型会在家庭用电量数据集上进行演示。通过之前的文章可知，如果一个模型比一个总RMSE约为465千瓦的七天预测朴素模型的RMSE小，就可以认为该模型是可用的。本文示例并没有调整超参数以获得最佳性能，所选择的结构和超参数都经过了小的尝试和误差。考虑到模型的随机性，最好对模型进行多次评估，并输出测试数据集的平均性能。
